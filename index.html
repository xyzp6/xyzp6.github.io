<html>
<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <link rel="stylesheet" href="css/head_tail.css">
    <link rel="stylesheet" href="css/index.css">
</head>
<body>

    <div class="header">
        <h1>基于Java的Web开发期末大作业</h1>
    </div>
    <!-- 添加导航栏 -->

    <ul class="nav">
        <li><img src="images/CJLU.jpg" alt="Logo"></li>
        <li><a href="#index">首页</a></li>
        <li><a href="#food">家乡美食</a></li>
        <li><a href="#sights">家乡景点</a></li>
        <li><a href="#culture">家乡文化</a></li>
        
        <script>
            document.querySelectorAll('a[href]').forEach(function(link) {
                link.addEventListener('click', function(event) {
                    event.preventDefault();
                    var target = document.querySelector(this.getAttribute('href'));
                    target.scrollIntoView({behavior: 'smooth'});
                });
            });
            document.getElementById('login-button').addEventListener('click', function() {
                window.location.href = 'login.jsp';
            });
            window.addEventListener('scroll', function() {
                // 获取导航栏中的所有链接
                var links = document.querySelectorAll('.nav a');
                console.log(links.length);
                // 定义一个变量来存储当前活动链接
                var currentActiveLink = null;

                // 循环遍历所有链接
                for (var i = 0; i < links.length; i++) {
                    // 获取链接的目标元素
                    var target = document.querySelector(links[i].hash);

                    // 检查目标元素是否在视图中
                    if (target.getBoundingClientRect().top <= window.innerHeight && target.getBoundingClientRect().bottom >= 0) {
                        // 如果当前没有活动链接，则将此链接设置为活动链接
                        if (!currentActiveLink) {
                            currentActiveLink = links[i];
                        } else {
                            // 如果已经有活动链接，则比较两个目标元素的位置，保留较靠近顶部的那个
                            var currentTarget = document.querySelector(currentActiveLink.hash);
                            if (target.getBoundingClientRect().top < currentTarget.getBoundingClientRect().top) {
                                currentActiveLink = links[i];
                            }
                        }
                    }
                }

                // 移除所有链接的活动类
                for (var i = 0; i < links.length; i++) {
                    links[i].classList.remove('active');
                }


                // 如果有当前活动链接，则为其添加活动类
                if (currentActiveLink) {
                    currentActiveLink.classList.add('active');
                }
            });
        </script>
    </ul>

    <div id="index">
        <!-- 首页内容 -->
        <div class="index_text">
            <h3>总介绍</h3>
            <h1>这是我的故乡——金华</h1>
            <p>金华市是浙江省辖地级市，位于浙江省中部，东邻台州市，南毗丽水市，西连衢州市，北接绍兴市、杭州市。金华市是长江三角洲中心区城市、浙江省中西部地区的中心城市。</p>
            <p>金华古称婺州，因其“地处金星与婺女两星争华之处”得名。自三国吴元宝鼎元年（266年）始设东阳郡建置以来，具有1800多年的历史和灿烂文化，是国家历史文化名城。</p>
            <p>金华文化属吴越文化，金华人属江浙民系。金华史称“小邹鲁”，素有“历史文化之邦、名人荟萃之地、文风鼎盛之城、山清水秀之乡”的美誉。</p>
        </div>
        <div class="main">
            <div class="main_card" id="c1"></div>
            <div class="main_card" id="c2"></div>
            <div class="main_card" id="c3"></div>
            <div class="main_card" id="c4"></div>
        </div>
        <script>
            window.addEventListener('load', function() {
                document.querySelector('.index_text').classList.add('slide-in');
            });
            window.addEventListener('load', function() {
                document.querySelector('.main').classList.add('slide-in');
            });
        </script>
    </div>

    <div id="food">
        <!-- 家乡美食内容 -->
        <div class="food_cards">
            <figure class="food_card"></figure>
        </div>
        <div class="food_text">
            <h3>美食</h3>
            <h1>这是我的味蕾——金华美食</h1>
            <p>金华是一个美食之城，拥有丰富多样的美食。这里的小吃种类繁多，包括金华火腿、金华酥饼、金华汤包、兰溪鸡子馃、永康肉麦饼等等。这些小吃都以其独特的风味和香气而闻名于世，吸引着众多美食爱好者前来品尝。</p>
            <p>金华的美食不仅仅局限于小吃，这里还有许多传统的菜肴和糕点。金华菜以其清淡爽口、色香味俱佳而著称，选料精细，调味讲究，注重原汁原味。金华糕点也颇具特色，如金华酥饼、金华佛手等，都是不可错过的美食。</p>
            <p>总之，金华是一个美食天堂，这里的美食种类繁多，风味独特。无论您喜欢什么口味的食物，在这里都能找到让您满意的美食。来到金华，一定要好好品尝一下当地的美食，相信您一定会留下难忘的回忆。</p>
            <button class="food_btn" id="food_btn_response">查看更多美食</button>
            <script>
                document.getElementById('food_btn_response').addEventListener('click', function() {
                    window.location.href = 'food.jsp';
                });
                const foodCard = document.querySelector('.food_card');
            </script>
        </div>
        <script>
            document.addEventListener('mousemove', (e) => {
                let xAxis = (window.innerWidth / 2 - e.pageX) / 25;
                let yAxis = (window.innerHeight / 2 - e.pageY) / 25;
                foodCard.style.transform = `rotateY(${xAxis}deg) rotateX(${yAxis}deg)`;
            });

            /* css3进入动画 */
            const foodCards = document.querySelector('.food_cards');
            const foodText = document.querySelector('.food_text');

            const observer = new IntersectionObserver((entries) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        foodCards.classList.add('slide-in');
                        foodText.classList.add('slide-in');
                    }
                });
            });

            observer.observe(foodCards);
            observer.observe(foodText);
        </script>
    </div>

    <div id="sights">
        <!-- 家乡景点内容 -->
        <div class="sights_text">
            <h3>美景</h3>
            <h1>这是我的眼界——金华景点</h1>
            <p>金华是一个风景优美的城市，拥有许多著名的旅游景点。其中最著名的当属横店影视城，这里有秦王宫、广州街香港街、清明上河图、明清宫苑、梦幻谷等众多景点，吸引着众多游客前来参观。</p>
            <p>此外，金华还有诸葛八卦村、双龙洞景区、东白山、仙华山风景名胜区等众多美丽的风景名胜。诸葛八卦村是诸葛亮后裔的最大聚居地，村子按照“九宫八卦”奇特布局，有原汁原味的明清古建筑200余所。</p>
            <p>金华还有许多其他美丽的风景名胜，如牛头山国家森林公园、郭洞古生态村等。这些地方都以其独特的风貌和优美的自然风光吸引着众多游客前来参观。来到金华，一定要好好欣赏一下当地的美景，相信您一定会留下难忘的回忆。</p>
            <button class="sights_btn" id="sights_btn_response">查看更多美景</button>
            <script>
                document.getElementById('sights_btn_response').addEventListener('click', function() {
                    window.location.href = 'sights.jsp';
                });
            </script>
        </div>
        <div class="sights_cards">
            <div class="sights_card"></div>
        </div>
        <script>
            /* css3进入动画 */
            const sightsText = document.querySelector('.sights_text');
            const sightsCards = document.querySelector('.sights_cards');

            const observer = new IntersectionObserver((entries) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        sightsText.classList.add('slide-in');
                        sightsCards.classList.add('slide-in');
                    }
                });
            });

            observer.observe(sightsText);
            observer.observe(sightsCards);
        </script>
    </div>

    <div id="culture">
        <!-- 家乡文化内容 -->
        <div class="culture_cards">
            <div class="culture_card"></div>
        </div>
        <div class="culture_text">
            <h3>文化</h3>
            <h1>这是我的传承——金华文化</h1>
            <p>金华是一个历史文化名城，拥有悠久的历史和灿烂的文化。金华古称婺州，因其“地处金星与婺女两星争华之处”得名，自三国吴元宝鼎元年（266年）始设东阳郡建置以来，具有1800多年的历史和灿烂文化。</p>
            <p>金华文化属吴越文化，金华人属江浙民系。金华素有“小邹鲁”之称，是一个历史文化之邦、名人荟萃之地、文风鼎盛之城、山清水秀之乡。这里有许多著名的非物质文化遗产，如义乌红糖、金华酒、金华火腿、婺剧变脸、永康鼓词、兰溪摊簧、金华道情等等。</p>
            <p>总之，金华是一个文化厚重的城市，这里的历史文化底蕴深厚，值得我们深入了解和探究。</p>
            <button class="culture_btn" id="culture_btn_response">查看更多文化</button>
            <script>
                document.getElementById('culture_btn_response').addEventListener('click', function() {
                    window.location.href = 'culture.jsp';
                });
            </script>
        </div>
        <script>
            const cultureCards = document.querySelector('.culture_cards');
            const cultureText = document.querySelector('.culture_text');

            const observer = new IntersectionObserver((entries) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        cultureCards.classList.add('slide-in');
                        cultureText.classList.add('slide-in');
                    }
                });
            });

            observer.observe(cultureCards);
            observer.observe(cultureText);
        </script>

    </div>

    <%
        Object[] dataArray = new Object[4];
        if(session.getAttribute("username")!=null) {
            //存在用户名，显示内容
            try {
                // 加载并注册MySQL JDBC驱动程序
                Class.forName("com.mysql.jdbc.Driver");

                // 建立与MySQL数据库的连接
                Connection conn = DriverManager.getConnection("jdbc:mysql://localhost:3306/jsp_last", "root", "1234");

                // 创建一个PreparedStatement对象并执行SQL查询语句
                String sql = "SELECT * FROM jsp_last.account WHERE username = ?";
                PreparedStatement pstmt = conn.prepareStatement(sql);
                pstmt.setString(1,String.valueOf(session.getAttribute("username")));
                ResultSet rs = pstmt.executeQuery();

                // 使用ResultSet对象处理查询结果
                if (rs.next()) {
                    // 从ResultSet中读取数据
                    String col1 = rs.getString("username");
                    String col2 = rs.getString("phone");
                    String col3 = rs.getString("youxiang");
                    String col4 = rs.getString("dizhi");

                    // 将数据存储在一个Object数组中
                    dataArray[0] = col1;
                    dataArray[1] = col2;
                    dataArray[2] = col3;
                    dataArray[3] = col4;
                }

                // 关闭数据库连接
                rs.close();
                pstmt.close();
                conn.close();
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    %>
    <%-- 检查 session 中的 username 属性是否不为 null --%>
    <c:if test="${not empty sessionScope.username}">
        <div id="person">
            <!-- 个人介绍内容 -->
            <div class="sights_text">
                <h3>个人信息</h3>
                <h1>这是您的用户名——<%= dataArray[0] %></h1>
                <p>您的电话：<%=dataArray[1]%></p>
                <p>您的邮箱：<%=dataArray[2]%></p>
                <p>您住在：<%=dataArray[3]%></p>
            </div>
            <div class="sights_cards">
                <div class="self_card"></div>
            </div>
            <script>
                /* css3进入动画 */
                const sightsText = document.querySelector('.sights_text');
                const sightsCards = document.querySelector('.sights_cards');

                const observer = new IntersectionObserver((entries) => {
                    entries.forEach((entry) => {
                        if (entry.isIntersecting) {
                            sightsText.classList.add('slide-in');
                            sightsCards.classList.add('slide-in');
                        }
                    });
                });

                observer.observe(sightsText);
                observer.observe(sightsCards);
            </script>
        </div>
    </c:if>


    <div style=" left: 0; bottom: 0; width: 100%; background-color: #e0ecfb; color: black; text-align: center;">
        <p>邮箱：2062201072@qq.com</p>
        <p>版权所有 © 2024</p>
    </div>
</body>
</html>
